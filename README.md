# MSSQL_Integrations
Система синхронизации и репликации данных между различными таблицами (и их представлениями) и базами данных.

Эта небольшая система состоит из:
- таблицы:
  - **DataObject** - описывает источник, приемник и опции обмена данными с рамках общего контекста (объекта данных)
  - **DataAttributes** - описывает колонки на стороне источника и приемника в рамках каждого объекта данных
  - **Log** - короткий журнал для записи запускаемых синхронизаций
  - **LogDetails** - журнал с деталями по каждой строке данных, которая была изменена в ходе синхронизации
- хранимые процедуры и функции:
  - **usp_generate** - собрать и получить скрипт с командой MERGE. Эта функция сама по себе не содержит полностью работающий скрипт. Её результат "дорабатывается" процедурой usp_runIntegration.
  - **usp_runIntegration** - запустить синронизацию конкретного объекта данных. Результат работы будет записан в таблицы Log и LogDetails.

## Пример настройки и запуска

Есть два сервера СУБД MSSQL на разных компьютерах:
- server1. Источник, генерирующий данные.
- server2. Потребитель данных источника.
Задача: синхронизировать данные, т.е. передавать их из таблицы на server1 в таблицу server2.

### Установка MSSQL_Integrations

Запустить скрипт MSSQL_Integrations.sql на server2. Этот скрипт создаст БД Integrations. В дальнейшем вся настройка будет выполняться в этой БД.

Сначала владелец или администратор server1 должен предоставить информацию для подключения к server1: адрес сервера, имя экземпляра, порт и т.д. Кроме этого необходимо получить название БД, таблицы (детальные описания колонок) и соответствующие права чтения.

На основе полученной информации на server2 создается объект linked server, реализующий подключение к server1. Роль источника может играть любая другая СУБД, к которой MSSQL потенциально может подключаться: PostgreSQL, Oracle, Firebird и т.д. Также необязательно использовать linked server. В качестве промежуточного звена могут использоваться команды openrowset или openquery. Или синхронизация может выполняться внутри самой СУБД.
